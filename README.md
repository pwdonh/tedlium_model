Adapted from PyTorch example: https://github.com/pytorch/examples/tree/master/word_language_model
